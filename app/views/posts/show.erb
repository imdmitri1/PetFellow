<%= erb :'partials/_errors', layout: false, locals: {errors: @errors} %>

<div class="row">
  <div class="col-sm-12 col-md-2 col-lg-2"></div>
  <div class="col-sm-12 col-md-8 col-lg-8">

    <div class="card border-info mb-3">


        <% if @post.pic_link %>
          <img src="<%=@post.pic_link%> " alt="<%=@post.pic_link%>" class="img-fluid">
        <% else %>
          <img src="<%=@post.image_url%> " alt="<%=@post.image_url%>" class="img-fluid">
        <% end %>

        <div class="row">


          <div class="col d-flex justify-content-center">
            <% if favorited?(@post) %>
            <form action="/favorite" method="Post">
              <input type="hidden" name="post_id" value="<%=@post.id%>">
              <button type="submit" class="btn btn-outline-success"><i class="fa fa-star" aria-hidden="true"></i></i></button>
            </form>
            <% else %>
            <form action="/favorite" method="Post">
              <input type="hidden" name="post_id" value="<%=@post.id%>">
              <button type="submit" class="btn btn-outline-success"><i class="fa fa-star-o" aria-hidden="true"></i></button>
            </form>
            <% end %>
          </div>

          <div class="col d-flex justify-content-center">
            <% if @post.likes.total_count && @post.likes.total_count > 0 %>
            <span class="like-count"><%= @post.likes.total_count %></span>
            <% end %>
          </div>

          <div class="col d-flex justify-content-center">
            <% if liked?(@post) %>
            <form action="/like/Post/<%=@post.id%>" method="post">
              <button type="submit" class="btn btn-outline-success"><i class="fa fa-heart" aria-hidden="true"></i></button>
            </form>
            <% else %>
            <form action="/like/Post/<%=@post.id%>" method="post">
              <button type="submit" class="btn btn-outline-success"><i class="fa fa-heart-o" aria-hidden="true"></i></button>
            </form>
            <% end %>
          </div>

        </div>

        <div class="info">
          <span class="name">
            <a href="/users/<%=@post.author.id%>">
              <%=@post.author.username%>:
            </a>
          </span>

          <span class="description">
                <%=@post.description%>
          </span>

        </div>

        <div class="row info">
          <div class="date align-items-center float-right font-weight-light">
             posted on <%=Date.strptime("#{@post.created_at}")%>
          </div>
        </div>

        <div>
          <% if admin? %>
            <form action="/posts/<%=@post.id%>" method="Post">
              <input type="hidden" name="_method" value="delete">
              <input type="submit" value="delete this post # <%= @post.id %>" class="btn btn-danger">
            </form>
          <% end %>
        </div>

    </div>

  </div>
  <div class="col-sm-12 col-md-2 col-lg-2"></div>
</div>

<!--  -->

<div class="row">
  <div class="col-sm-12 col-md-2 col-lg-2"></div>
  <div class="col-sm-12 col-md-8 col-lg-8">
    <% if @post.comments.any? %>
      <h3 class="text-center">Comments:</h3>
        <ul class="list-group">
          <% @post.comments.order("created_at").each do |comment| %>
          <li class="list-group-item">

            <div class="info">
              <span class="name">
                <a href="/users/<%=@post.author.id%>">
                  <%=@post.author.username%>:
                </a>
              </span>

              <span class="description">
                    <%=@post.description%>
              </span>
            </div>

            <div class="">

              <div class="d-inline-block">
                <% if @post.likes.total_count && @post.likes.total_count > 0 %>
                <span class="like-count"><%= @post.likes.total_count %></span>
                <% end %>
              </div>

              <div class="d-inline-block">
                <% if liked?(@post) %>
                <form action="/like/Post/<%=@post.id%>" method="post">
                  <button type="submit" class="btn btn-outline-success"><i class="fa fa-heart" aria-hidden="true"></i></button>
                </form>
                <% else %>
                <form action="/like/Post/<%=@post.id%>" method="post">
                  <button type="submit" class="btn btn-outline-success"><i class="fa fa-heart-o" aria-hidden="true"></i></button>
                </form>
                <% end %>
              </div>


                <% if author?(comment.author_id) || admin? %>
                <a href="/posts/<%=@post.id%>/comments/<%=comment.id%>/edit" class="btn btn-link btn-sm">edit</a>
                <div class="d-inline-block">
                  <form action="/posts/<%=@post.id%>/comments/<%=comment.id%>" method="Post">
                    <input type="hidden" name="_method" value="delete">
                    <input type="submit" value="delete" class="btn btn-link btn-sm">
                  </form>
                </div>
                <% end %>
            </div>

            <div class="row info">
              <div class="date align-items-center float-right font-weight-light">
                 posted on <%=Date.strptime("#{@post.created_at}")%>
              </div>
            </div>

          </li>
        <% end %>
      </ul>
    <% else %>
      <h3>No comments yet</h3>
    <% end %>
    <a href="/posts/<%=@post.id%>/comments/new" class="btn btn-info d-block">add a comment</a>
  </div>
  <div class="col-sm-12 col-md-2 col-lg-2"></div>
<div>

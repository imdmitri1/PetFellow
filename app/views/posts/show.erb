<%= erb :'partials/_errors', layout: false, locals: {errors: @errors} %>

<div class="">
  <% if @post.pic_link %>
    <img src="<%=@post.pic_link%> " alt="<%=@post.pic_link%> ">
  <% else %>
    <img src="<%=@post.image_url%> " alt="<%=@post.image_url%> ">
  <% end %>
</div>
<div class=""><%= @post.description%> </div>
<div class=""><%= @post.author.username%> </div>

<div class="">

  <div>
    <% if liked?(@post) %>
      <form action="/like/Post/<%=@post.id%>" method="post">
        <input type="submit" value="liked">
      </form>
    <% else %>
      <form action="/like/Post/<%=@post.id%>" method="post">
        <input type="submit" value="like!">
      </form>
    <% end %>
  </div>

  <div>
    <% if @post.likes.total_count && @post.likes.total_count > 0 %>
      <span class=""><%= @post.likes.total_count %></span>
    <% end %>
  </div>

</div>

<div>
  <% if favorited?(@post) %>
    <form action="/favorite" method="Post">
      <input type="hidden" name="post_id" value="<%=@post.id%>">
      <input type="submit" value="unfavor">
    </form>
  <% else %>
    <form action="/favorite" method="Post">
      <input type="hidden" name="post_id" value="<%=@post.id%>">
      <input type="submit" value="favor">
    </form>
  <% end %>
</div>

<% if author?(@post.author_id) %>
  <a href="/posts/<%=@post.id%>/edit">Edit post</a>
  <form action="/posts/<%=@post.id%>" method="Post">
    <input type="hidden" name="_method" value="delete">
    <input type="submit" value="delete">
  </form>
<% end %>

<div>
  <% if @post.comments.any? %>
    <h3>Comments:</h3>
    <ul>
      <% @post.comments.order("created_at").each do |comment| %>
        <li>
          <%= comment.content %>
          <br>
          <%= comment.author.username %>

          <div class="">

            <div>
              <% if liked?(comment) %>
                <form action="/like/Comment/<%=comment.id%>" method="post">
                  <input type="submit" value="liked">
                </form>
              <% else %>
                <form action="/like/Comment/<%=comment.id%>" method="post">
                  <input type="submit" value="like!">
                </form>
              <% end %>
            </div>

            <div>
              <% if comment.likes.total_count && comment.likes.total_count > 0 %>
                <span class=""><%= comment.likes.total_count %></span>
              <% end %>
            </div>

          </div>

          <% if author?(comment.author_id) %>
            <a href="/posts/<%=@post.id%>/comments/<%=comment.id%>/edit">edit comment</a>
            <form action="/posts/<%=@post.id%>/comments/<%=comment.id%>" method="Post">
              <input type="hidden" name="_method" value="delete">
              <input type="submit" value="delete comment">
            </form>
          <% end %>

        </li>
      <% end %>
    </ul>
  <% else %>
    <h3>No comments yet</h3>
  <% end %>
</div>

<a href="/posts/<%=@post.id%>/comments/new">add a comment</a>
